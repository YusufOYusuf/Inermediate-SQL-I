SELECT *
FROM LGDEPARTMENT 
ORDER BY DEPT_NAME ASC;






SELECT *
FROM LGEMPLOYEE;

SELECT EMP_FNAME, EMP_LNAME, EMP_EMAIL
FROM LGEMPLOYEE
WHERE EMP_HIREDATE >= '2005-1-1' AND EMP_HIREDATE <='2014-12-31'
ORDER BY EMP_LNAME ASC, EMP_FNAME;






SELECT * FROM LGEMPLOYEE;
SELECT * FROM LGSALARY_HISTORY;

SELECT LGEMPLOYEE.EMP_NUM, LGEMPLOYEE.EMP_LNAME,
       LGEMPLOYEE.EMP_FNAME, LGSALARY_HISTORY.SAL_FROM,
       LGSALARY_HISTORY.SAL_END, SAL_AMOUNT
FROM LGEMPLOYEE, LGSALARY_HISTORY
WHERE LGEMPLOYEE.EMP_NUM=LGSALARY_HISTORY.EMP_NUM
AND (LGEMPLOYEE.EMP_NUM=83731 OR LGEMPLOYEE.EMP_NUM=83745 OR LGEMPLOYEE.EMP_NUM=84039)







SELECT BRAND_ID, AVG(PROD_PRICE)
FROM LGPRODUCT
GROUP BY BRAND_ID;

SELECT ROUND(MAX(AVG_PRICE),2) AS "LARGEST AVERAGE"
FROM (SELECT BRAND_ID, AVG(PROD_PRICE) AS AVG_PRICE
      FROM LGPRODUCT
      GROUP BY BRAND_ID) AS BRAND_AVG;








SELECT LGPRODUCT.BRAND_ID, BRAND_NAME, BRAND_TYPE, ROUND(AVG(PROD_PRICE), 2) AS FMT_AVGPRICE
FROM LGPRODUCT JOIN LGBRAND ON LGPRODUCT.BRAND_ID=LGBRAND.BRAND_ID
GROUP BY LGPRODUCT.BRAND_ID
HAVING FMT_AVGPRICE=
        (SELECT ROUND(MAX(AVG_PRICE), 2)
        FROM (SELECT BRAND_ID, AVG(PROD_PRICE) AS AVG_PRICE
              FROM LGPRODUCT 
              GROUP BY BRAND_ID) AS BRAND_AVG);









SELECT LGEMPLOYEE.EMP_NUM, EMP_LNAME, EMP_FNAME, SAL_AMOUNT
FROM LGEMPLOYEE JOIN LGSALARY_HISTORY ON LGEMPLOYEE.EMP_NUM=LGSALARY_HISTORY.EMP_NUM
WHERE SAL_AMOUNT=(SELECT MIN(SAL_AMOUNT)
                  FROM LGSALARY_HISTORY
                  WHERE LGEMPLOYEE.EMP_NUM=LGSALARY_HISTORY.EMP_NUM)
ORDER BY EMP_NUM;












SELECT L1.INV_NUM, L1.LINE_NUM, P1.PROD_SKU, P1.PROD_DESCRIPT, L2.LINE_NUM,
       P2.PROD_SKU, P2.PROD_DESCRIPT, P1.BRAND_ID
FROM (LGLINE AS L1 JOIN LGPRODUCT AS P1 ON L1.PROD_SKU=P1.PROD_SKU) JOIN
     (LGLINE AS L2 JOIN LGPRODUCT AS P2 ON L2.PROD_SKU=P2.PROD_SKU) ON L1.INV_NUM=L2.INV_NUM
WHERE P1.PROD_CATEGORY = "SEALER"
AND P2.PROD_CATEGORY = "TOP COAT"
AND P1.BRAND_ID=P2.BRAND_ID
ORDER BY L1.INV_NUM, L1.LINE_NUM, L2.LINE_NUM DESC;














SELECT E.EMP_NUM, EMP_FNAME, EMP_LNAME, EMP_EMAIL, TOTAL
FROM LGEMPLOYEE AS E JOIN
                (SELECT EMPLOYEE_ID, SUM(LINE_QTY) AS "TOTAL"
                FROM LGINVOICE AS I JOIN LGLINE AS L ON I.INV_NUM=L.INV_NUM JOIN
                        LGPRODUCT AS P ON L.PROD_SKU=P.PROD_SKU JOIN
                        LGBRAND AS B ON B.BRAND_ID=P.BRAND_ID
                WHERE BRAND_NAME = "BINDER PRIME" AND INV_DATE BETWEEN "2017-11-01" AND "2017-12-06"
                GROUP BY EMPLOYEE_ID) AS EMP_SALES ON E.EMP_NUM = EMP_SALES.EMPLOYEE_ID
WHERE TOTAL = (SELECT MAX(TOTAL2)
               FROM (SELECT EMPLOYEE_ID, SUM(LINE_QTY) AS "TOTAL2"
                     FROM LGINVOICE AS I JOIN LGLINE AS L ON I.INV_NUM=L.INV_NUM JOIN
                             LGPRODUCT AS P ON L.PROD_SKU=P.PROD_SKU JOIN
                             LGBRAND AS B ON B.BRAND_ID=P.BRAND_ID
               WHERE BRAND_NAME = "BINDER PRIME" AND INV_DATE BETWEEN "2017-11-01" AND "2017-12-06"
               GROUP BY EMPLOYEE_ID) AS EMP_SALES2)
GROUP BY EMP_LNAME;
    


